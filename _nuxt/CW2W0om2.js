import{d as A,s as w,o as N,F as se,h as le,x as _,G as R,H as oe,_ as $,y as p,z as l,I as M,k as h,J as F,K as f,L as ie,M as re,B as C,A as y,D as L,N as de,O as E,P as ue,Q as ce,R as q,S as me,T as B,U as pe,V as fe,r as V,W as H,X as z,Y as Z,C as S,E as O,Z as W,g as ve,$ as I,a0 as _e}from"#entry";import{B as be}from"./BpLe_0L0.js";import{u as ge}from"./BN1nsTRu.js";const he=Symbol.for("nuxt:client-only"),Ce=A({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(e,{slots:t,attrs:a}){const s=w(!1);N(()=>{s.value=!0});const i=R();return i&&(i._nuxtClientOnly=!0),oe(he,!0),()=>{if(s.value){const n=t.default?.();return n&&n.length===1?[se(n[0],a)]:n}const d=t.fallback||t.placeholder;if(d)return le(d);const u=e.fallback||e.placeholder||"",o=e.fallbackTag||e.placeholderTag||"span";return _(o,a,u)}}}),ye={},Se={class:"page-header"};function $e(e,t){return p(),_("div",null,[l("h1",Se,[M(e.$slots,"default",{},void 0)])])}const Le=Object.assign($(ye,[["render",$e],["__scopeId","data-v-dfb1e205"]]),{__name:"PageHeader"}),Ae=["disabled"],we={class:"button-base-content"},Me={class:"button-base-spinner spinner"},Ve={class:"button-base-text"},Be=A({__name:"ButtonBase",props:{loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},variant:{default:"primary"}},emits:["click"],setup(e,{emit:t}){const a=t,s=h(()=>e.disabled||e.loading),i=h(()=>`button-base--${e.variant}`);function d(){s.value||a("click")}return(u,o)=>(p(),_("button",{class:F(["button-base",f(i),{loading:u.loading}]),disabled:u.disabled,onClick:d},[l("span",we,[ie(l("div",Me,null,512),[[re,u.loading]]),l("span",Ve,[M(u.$slots,"default",{},void 0)])])],10,Ae))}}),Oe=Object.assign($(Be,[["__scopeId","data-v-3b2b3027"]]),{__name:"UiButtonBase"}),ke={},Ie={width:"7",height:"4",viewBox:"0 0 7 4",xmlns:"http://www.w3.org/2000/svg"};function xe(e,t){return p(),_("svg",Ie,[...t[0]||(t[0]=[l("g",null,[l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.03447 0.253496C3.8722 0.0898395 3.65794 2.7968e-07 3.42826 2.9976e-07C3.19914 3.1979e-07 2.98374 0.0898396 2.82262 0.253496L0.167524 3.01277C-0.0558768 3.2388 -0.0558768 3.60445 0.167524 3.83048C0.390353 4.05651 0.752023 4.05651 0.975423 3.83048L3.42826 1.27549L5.88167 3.83048C6.10507 4.05651 6.46617 4.05651 6.68957 3.83048C6.91297 3.60445 6.91297 3.2388 6.68957 3.01277L4.03447 0.253496Z"}),l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.03447 0.253496C3.8722 0.0898395 3.65794 2.7968e-07 3.42826 2.9976e-07C3.19914 3.1979e-07 2.98374 0.0898396 2.82262 0.253496L0.167524 3.01277C-0.0558768 3.2388 -0.0558768 3.60445 0.167524 3.83048C0.390353 4.05651 0.752023 4.05651 0.975423 3.83048L3.42826 1.27549L5.88167 3.83048C6.10507 4.05651 6.46617 4.05651 6.68957 3.83048C6.91297 3.60445 6.91297 3.2388 6.68957 3.01277L4.03447 0.253496Z"})],-1)])])}const Y=$(ke,[["render",xe]]),k={ASC:"asc",DESC:"desc"},Te={class:"button-sort-text"},Pe={class:"button-sort-icons"},Ne=A({__name:"ButtonSort",props:{sortParams:{},field:{},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["nextSort"],setup(e,{emit:t}){const a=t,s=h(()=>({"button-sort-active":e.field===e.sortParams.sortBy,"button-sort-asc":e.sortParams.sortOrder==="asc","button-sort-desc":e.sortParams.sortOrder==="desc"})),i=h(()=>e.disabled||e.loading);function d(){if(i.value)return;const u=e.sortParams.sortOrder===k.ASC?k.DESC:k.ASC;a("nextSort",{sortOrder:u,sortBy:e.field})}return(u,o)=>(p(),_("button",{class:F(["button-sort",f(s),{disabled:f(i)}]),onClick:d},[l("span",Te,[M(u.$slots,"default",{},void 0)]),l("div",Pe,[C(Y,{class:"button-sort-icon button-sort-icon__asc"}),C(Y,{class:"button-sort-icon button-sort-icon__desc"})])],2))}}),Re=Object.assign($(Ne,[["__scopeId","data-v-7819df54"]]),{__name:"UiButtonSort"}),Fe={class:"apartment-card-title"},Ee={class:"apartment-card-text-container"},We={class:"apartment-card-area"},je={class:"apartment-card-level"},Ue={class:"apartment-card-price"},De=["src","alt"],He=A({__name:"ApartmentCard",props:{apartment:{}},emits:["openApartment"],setup(e,{emit:t}){const a=t;function s(i){a("openApartment",i)}return(i,d)=>(p(),_("button",{class:"apartment-card",type:"button",onClick:d[0]||(d[0]=u=>s(i.apartment.id))},[l("div",null,[l("h3",Fe,y(i.apartment.title),1),l("div",Ee,[l("span",We,[L(y(i.apartment.area)+" м",1),d[1]||(d[1]=l("sup",null,"2",-1))]),l("span",je,[L(y(i.apartment.level)+" ",1),d[2]||(d[2]=l("span",{class:"apartment-card-level__max"},"из 17",-1))]),l("span",Ue,y(i.apartment.price)+" ₽",1)])]),l("img",{class:"apartment-card-image",src:`/images/${i.apartment.imgUrl}`,alt:i.apartment.imgAlt},null,8,De)]))}}),ze=Object.assign($(He,[["__scopeId","data-v-53ed4a15"]]),{__name:"ApartmentCard"});function Ge(e){return ue()?(ce(e),!0):!1}const j=new WeakMap,Xe=(...e)=>{var t;const a=e[0],s=(t=R())==null?void 0:t.proxy;if(s==null&&!q())throw new Error("injectLocal must be called in setup");return s&&j.has(s)&&a in j.get(s)?j.get(s)[a]:me(...e)},Ze=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ye=Object.prototype.toString,Je=e=>Ye.call(e)==="[object Object]";function J(e){return e.endsWith("rem")?Number.parseFloat(e)*16:Number.parseFloat(e)}function U(e){return Array.isArray(e)?e:[e]}function Qe(e){return R()}function Ke(e,t=!0,a){Qe()?N(e,a):t?e():de(e)}function qe(e,t,a){return E(e,t,{...a,immediate:!0})}const X=Ze?window:void 0;function et(e){var t;const a=B(e);return(t=a?.$el)!=null?t:a}function G(...e){const t=[],a=()=>{t.forEach(o=>o()),t.length=0},s=(o,n,r,v)=>(o.addEventListener(n,r,v),()=>o.removeEventListener(n,r,v)),i=h(()=>{const o=U(B(e[0])).filter(n=>n!=null);return o.every(n=>typeof n!="string")?o:void 0}),d=qe(()=>{var o,n;return[(n=(o=i.value)==null?void 0:o.map(r=>et(r)))!=null?n:[X].filter(r=>r!=null),U(B(i.value?e[1]:e[0])),U(f(i.value?e[2]:e[1])),B(i.value?e[3]:e[2])]},([o,n,r,v])=>{if(a(),!o?.length||!n?.length||!r?.length)return;const b=Je(v)?{...v}:v;t.push(...o.flatMap(m=>n.flatMap(c=>r.map(g=>s(m,c,g,b)))))},{flush:"post"}),u=()=>{d(),a()};return Ge(a),u}function tt(){const e=w(!1),t=R();return t&&N(()=>{e.value=!0},t),e}function at(e){const t=tt();return h(()=>(t.value,!!e()))}const nt=Symbol("vueuse-ssr-width");function st(){const e=q()?Xe(nt,null):null;return typeof e=="number"?e:void 0}function lt(e,t={}){const{window:a=X,ssrWidth:s=st()}=t,i=at(()=>a&&"matchMedia"in a&&typeof a.matchMedia=="function"),d=w(typeof s=="number"),u=w(),o=w(!1),n=r=>{o.value=r.matches};return pe(()=>{if(d.value){d.value=!i.value;const r=B(e).split(",");o.value=r.some(v=>{const b=v.includes("not all"),m=v.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),c=v.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let g=!!(m||c);return m&&g&&(g=s>=J(m[1])),c&&g&&(g=s<=J(c[1])),b?!g:g});return}i.value&&(u.value=a.matchMedia(B(e)),o.value=u.value.matches)}),G(u,"change",n,{passive:!0}),h(()=>o.value)}function ot(e={}){const{window:t=X,initialWidth:a=Number.POSITIVE_INFINITY,initialHeight:s=Number.POSITIVE_INFINITY,listenOrientation:i=!0,includeScrollbar:d=!0,type:u="inner"}=e,o=w(a),n=w(s),r=()=>{if(t)if(u==="outer")o.value=t.outerWidth,n.value=t.outerHeight;else if(u==="visual"&&t.visualViewport){const{width:b,height:m,scale:c}=t.visualViewport;o.value=Math.round(b*c),n.value=Math.round(m*c)}else d?(o.value=t.innerWidth,n.value=t.innerHeight):(o.value=t.document.documentElement.clientWidth,n.value=t.document.documentElement.clientHeight)};r(),Ke(r);const v={passive:!0};if(G("resize",r,v),t&&u==="visual"&&t.visualViewport&&G(t.visualViewport,"resize",r,v),i){const b=lt("(orientation: portrait)");E(b,()=>r())}return{width:o,height:n}}const x=new Intl.NumberFormat("ru-RU");function it(){return{fetchApartments:async function(t){const{data:a,total:s}=await $fetch("/api/apartments",{query:t});return{data:a,total:s}}}}const ee=fe("apartments",()=>{const e=V([]),t=V(0),a=h(()=>s(e.value));function s(d){return d.map(u=>({...u,price:x.format(u.price),area:x.format(u.area)}))}async function i(d){const{data:u,total:o}=await it().fetchApartments(d);e.value=u,t.value=o}return{apartmentListComputed:a,getApartments:i,totalApartmentsLength:t}}),rt={class:"apartments-table"},dt={class:"apartments-table-header"},ut={key:0},ct={key:0,class:"apartments-table-body__preloader"},mt={key:0,class:"apartments-table-no-result"},pt={key:0,class:"apartments-table-card",tabindex:"0",type:"button"},ft=["src","alt"],vt={class:"apartments-table-card-title"},_t={class:"apartments-table-card-area"},bt={class:"apartments-table-card-level"},gt={class:"apartments-table-card-price"},ht={class:"apartments-table-footer"},Ct=A({__name:"ApartmentsTable",props:{apartmentsList:{},isLoading:{type:Boolean},sortParams:{}},emits:["nextPage","nextSort"],setup(e,{emit:t}){const a=ee(),s=[{field:"area",label:"S, м",sup:2},{field:"level",label:"Этаж"},{field:"price",label:"Цена, ₽"}],i=t,d=V(1);function u(){d.value++,i("nextPage",d.value)}const o=h(()=>!!e.apartmentsList.length&&a.totalApartmentsLength>e.apartmentsList.length),n=h(()=>!e.apartmentsList.length&&e.isLoading),{width:r}=ot(),v=h(()=>r.value>1440);return(b,m)=>(p(),_("section",rt,[l("header",dt,[m[1]||(m[1]=l("span",{class:"apartments-table-header__label apartments-table-header__image"},"Планировка",-1)),m[2]||(m[2]=l("span",{class:"apartments-table-header__label apartments-table-header__title"},"Квартира",-1)),(p(),_(H,null,z(s,c=>C(Re,{key:c.field,field:c.field,"sort-params":b.sortParams,loading:b.isLoading,onNextSort:m[0]||(m[0]=g=>i("nextSort",g))},{default:S(()=>[l("span",null,[L(y(c.label),1),c.sup?(p(),_("sup",ut,y(c.sup),1)):W("",!0)])]),_:2},1032,["field","sort-params","loading"])),64))]),l("div",{class:F(["apartments-table-body",{loading:b.isLoading}])},[C(Z,{name:"fade-in"},{default:S(()=>[f(n)?(p(),_("div",ct,[...m[3]||(m[3]=[l("div",{class:"apartments-table-body__preloader-spinner spinner-lg"},null,-1)])])):(p(),O(Z,{key:1,name:"fade-up",tag:"div",class:"transition-container"},{default:S(()=>[!b.apartmentsList.length&&!b.isLoading?(p(),_("div",mt,[...m[4]||(m[4]=[l("h3",null,"Ничего не найдено",-1),l("p",null,"Попробуйте изменить параметры фильтра.",-1)])])):W("",!0),(p(!0),_(H,null,z(b.apartmentsList,c=>(p(),_("div",{key:c.id},[f(v)?(p(),_("button",pt,[l("img",{class:"apartments-table-card-image",src:`/images/${c.imgUrl}`,alt:c.imgAlt},null,8,ft),l("h3",vt,y(c.title),1),l("span",_t,y(c.area),1),l("span",bt,[L(y(c.level)+" ",1),m[5]||(m[5]=l("span",{class:"apartments-table-card-level__max"},"из 17",-1))]),l("span",gt,y(c.price),1)])):(p(),O(ze,{key:1,apartment:c,tabindex:"0","aria-label":"Открыть карточку квартиры"},null,8,["apartment"]))]))),128))]),_:1}))]),_:1})],2),l("div",ht,[f(o)?(p(),O(Oe,{key:0,loading:b.isLoading,onClick:u},{default:S(()=>[...m[6]||(m[6]=[L(" Загрузить еще ",-1)])]),_:1},8,["loading"])):W("",!0)])]))}}),yt=Object.assign($(Ct,[["__scopeId","data-v-119d1894"]]),{__name:"ApartmentsTable"}),St=[1,2,3,4],T={MIN:1e6,MAX:28e6},P={MIN:16,MAX:200},$t=A({__name:"ButtonRoundFilter",props:{active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},setup(e){return(t,a)=>(p(),O(be,{class:F(["button-round-filter",{active:t.active}]),disabled:t.disabled},{default:S(()=>[M(t.$slots,"default",{},void 0,!0)]),_:3},8,["class","disabled"]))}}),Lt=Object.assign($($t,[["__scopeId","data-v-484d48de"]]),{__name:"UiButtonRoundFilter"}),At={},wt={class:"button-text"},Mt={class:"button-text-icon"};function Vt(e,t){return p(),_("button",wt,[M(e.$slots,"label",{},void 0),l("div",Mt,[M(e.$slots,"icon",{},void 0)])])}const Bt=Object.assign($(At,[["render",Vt],["__scopeId","data-v-eeb398cc"]]),{__name:"UiButtonText"}),Ot={class:"filter-range-container"},kt={class:"filter-range"},It={class:"filter-range__header"},xt={class:"filter-range__description"},Tt={class:"filter-range__value"},Pt={class:"filter-range__value"},Nt=A({__name:"FilterRange",props:{modelValue:{},min:{},max:{},step:{},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const a=V([...e.modelValue]),s=V(!1),i=h(()=>({min:x.format(a.value[0]),max:x.format(a.value[1])})),d=t;function u(n){s.value=!0,a.value=n}function o(n){s.value=!1,a.value=n,d("update:modelValue",a.value)}return E(()=>e.modelValue,n=>{s.value||(a.value=[...n])},{deep:!0}),(n,r)=>{const v=ve("Slider");return p(),_("div",Ot,[l("div",kt,[l("span",It,[M(n.$slots,"default",{},void 0)]),l("div",xt,[l("div",null,[r[1]||(r[1]=l("span",null,"от ",-1)),l("span",Tt,y(f(i).min),1)]),l("div",null,[r[2]||(r[2]=l("span",null," до ",-1)),l("span",Pt,y(f(i).max),1)])])]),C(v,{modelValue:f(a),"onUpdate:modelValue":r[0]||(r[0]=b=>I(a)?a.value=b:null),min:n.min,max:n.max,step:n.step,class:"filter-range-slider",tooltips:!1,disabled:n.disabled,aria:{"aria-label":"Кнопка управления диапозоном"},onSlide:u,onChange:o},null,8,["modelValue","min","max","step","disabled"])])}}}),Q=Object.assign($(Nt,[["__scopeId","data-v-a65acb5e"]]),{__name:"UiFilterRange"}),Rt={},Ft={width:"8",height:"8",viewBox:"0 0 8 8",xmlns:"http://www.w3.org/2000/svg"};function Et(e,t){return p(),_("svg",Ft,[...t[0]||(t[0]=[l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.99996 5.22223L1.37727 7.84492C1.12213 8.10007 0.641687 8.0333 0.304183 7.6958C-0.0333213 7.35829 -0.100086 6.87786 0.15506 6.62271L2.77775 4.00002L0.155017 1.37729C-0.100129 1.12214 -0.0333644 0.641701 0.30414 0.304197C0.641644 -0.0333071 1.12208 -0.100072 1.37723 0.155074L3.99996 2.77781L6.62282 0.154956C6.87796 -0.10019 7.3584 -0.0334256 7.6959 0.304079C8.03341 0.641583 8.10017 1.12202 7.84503 1.37717L5.22217 4.00002L7.84498 6.62283C8.10013 6.87797 8.03336 7.35841 7.69586 7.69592C7.35836 8.03342 6.87792 8.10019 6.62277 7.84504L3.99996 5.22223Z"},null,-1),l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.99996 5.22223L1.37727 7.84492C1.12213 8.10007 0.641687 8.0333 0.304183 7.6958C-0.0333213 7.35829 -0.100086 6.87786 0.15506 6.62271L2.77775 4.00002L0.155017 1.37729C-0.100129 1.12214 -0.0333644 0.641701 0.30414 0.304197C0.641644 -0.0333071 1.12208 -0.100072 1.37723 0.155074L3.99996 2.77781L6.62282 0.154956C6.87796 -0.10019 7.3584 -0.0334256 7.6959 0.304079C8.03341 0.641583 8.10017 1.12202 7.84503 1.37717L5.22217 4.00002L7.84498 6.62283C8.10013 6.87797 8.03336 7.35841 7.69586 7.69592C7.35836 8.03342 6.87792 8.10019 6.62277 7.84504L3.99996 5.22223Z"},null,-1)])])}const Wt=$(Rt,[["render",Et]]),jt={class:"apartments-filter"},Ut={class:"apartments-filter-rooms"},Dt={class:"apartments-filter-slider"},Ht={class:"apartments-filter-reset"},zt=A({__name:"ApartmentsFilter",props:{modelValue:{},isLoading:{type:Boolean,default:!1}},emits:["update:modelValue","resetFilter"],setup(e,{emit:t}){const a=t;function s(o){e.modelValue.rooms!==o&&a("update:modelValue",{...e.modelValue,rooms:o})}const i=h({get:()=>[e.modelValue.priceMin,e.modelValue.priceMax],set:([o,n])=>{a("update:modelValue",{...e.modelValue,priceMin:o,priceMax:n})}}),d=h({get:()=>[e.modelValue.areaMin,e.modelValue.areaMax],set:([o,n])=>{a("update:modelValue",{...e.modelValue,areaMin:o,areaMax:n})}}),u=h(()=>e.modelValue.rooms);return(o,n)=>(p(),_("div",jt,[l("div",Ut,[(p(!0),_(H,null,z(f(St),r=>(p(),O(Lt,{key:r,size:44,class:"apartments-filter-rooms__button",active:f(u)==r,disabled:o.isLoading,onClick:v=>s(r)},{default:S(()=>[l("span",null,y(r)+"к",1)]),_:2},1032,["active","disabled","onClick"]))),128))]),l("div",Dt,[C(Q,{modelValue:f(i),"onUpdate:modelValue":n[0]||(n[0]=r=>I(i)?i.value=r:null),min:f(T).MIN,max:f(T).MAX,step:5e5,disabled:o.isLoading},{default:S(()=>[...n[3]||(n[3]=[L(" Стоимость квартиры, ₽ ",-1)])]),_:1},8,["modelValue","min","max","disabled"]),C(Q,{modelValue:f(d),"onUpdate:modelValue":n[1]||(n[1]=r=>I(d)?d.value=r:null),min:f(P).MIN,max:f(P).MAX,step:5,disabled:o.isLoading},{default:S(()=>[...n[4]||(n[4]=[L(" Площадь, м",-1),l("sup",null,"2",-1)])]),_:1},8,["modelValue","min","max","disabled"])]),l("div",Ht,[C(Bt,{onClick:n[2]||(n[2]=r=>a("resetFilter"))},{label:S(()=>[...n[5]||(n[5]=[L("Сбросить параметры",-1)])]),icon:S(()=>[C(Wt)]),_:1})])]))}}),Gt=Object.assign($(zt,[["__scopeId","data-v-5e76c5b4"]]),{__name:"ApartmentsFilter"}),Xt=(e,t)=>{let a=null;const s=(...i)=>{a&&clearTimeout(a),a=setTimeout(()=>e(...i),t)};return s.cancel=()=>{a&&(clearTimeout(a),a=null)},s},Zt={class:"apartments-page","aria-labelledby":"apartments-page-header"},Yt={class:"apartments-page-container","aria-label":"Список и фильтр квартир"},Jt={class:"apartments-page-filter-container","aria-label":"Фильтр квартир"},K=5,D="FILTER_PARAMS",Qt=A({__name:"ApartmentsPage",setup(e){ge({title:"Квартиры"});const t=ee(),a={limit:K,sortBy:"",sortOrder:k.ASC,priceMin:T.MIN,priceMax:T.MAX,areaMin:P.MIN,areaMax:P.MAX,rooms:null},s=V(a),i=h(()=>({sortBy:s.value.sortBy,sortOrder:s.value.sortOrder})),d=V(!0);function u(c){s.value.limit=K*c}function o(c){let g=c.sortOrder;c.sortBy!==s.value.sortBy&&(g=k.ASC),s.value.sortOrder=g,s.value.sortBy=c.sortBy}const n=async()=>{try{await t.getApartments({...s.value})}finally{d.value=!1}},r=Xt(n,500);function v(){s.value={...a},localStorage.removeItem(D)}function b(){localStorage.setItem(D,JSON.stringify(s.value))}function m(){const c=localStorage.getItem(D);c&&(s.value=JSON.parse(c))}return N(()=>{m(),n()}),E(()=>({...s.value}),()=>{b(),d.value=!0,r()},{deep:!0}),(c,g)=>{const te=Le,ae=Ce;return p(),_("main",Zt,[l("section",Yt,[l("header",null,[C(te,{id:"apartments-page-header",class:"apartments-page-header"},{default:S(()=>[...g[1]||(g[1]=[L("Квартиры",-1)])]),_:1})]),C(yt,{"apartments-list":f(t).apartmentListComputed,"sort-params":f(i),"is-loading":f(d),onNextPage:u,onNextSort:o},null,8,["apartments-list","sort-params","is-loading"])]),l("aside",Jt,[C(ae,null,{default:S(()=>[C(_e,{name:"fade-in"},{default:S(()=>[C(Gt,{modelValue:f(s),"onUpdate:modelValue":g[0]||(g[0]=ne=>I(s)?s.value=ne:null),"is-loading":f(d),onResetFilter:v},null,8,["modelValue","is-loading"])]),_:1})]),_:1})])])}}}),ta=$(Qt,[["__scopeId","data-v-da26fc32"]]);export{ta as default};
